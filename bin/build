#!/usr/bin/env bash
set -eo pipefail

# create a version.json
[ -z $TRAVIS_TAG ] || printf \
  '{"commit":"%s","version":"%s","source":"https://github.com/%s","build":"https://travis-ci.org/%s/builds/%s"}\n' \
  "$TRAVIS_COMMIT" \
  "$TRAVIS_TAG" \
  "$TRAVIS_REPO_SLUG" \
  "$TRAVIS_REPO_SLUG" \
  "$TRAVIS_BUILD_ID" \
> version.json

echo "Building the docker image with the tag app:build"
docker build -t app:build .
